<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-ajax/core-xhr.html">
<link rel="import" href="../bower_components/core-ajax/core-ajax.html">

<polymer-element name="deploy-app" attributes="manifest">>
  <template>
    <!-- <core-xhr id="xhr"></core-xhr> -->
    <core-ajax
      id="ajax"
      auto
      url="{{manifest}}"
      handleAs="json"
      on-core-response="{{manifestLoaded}}"
      ></core-ajax>
    <content></content>
  </template>
  <script>
    (function() {
      function capitalize(str) {
        var split = str.split(' ');
        for (var i = 0; i < split.length; i++) {
          var s = split[i];
          split[i] = s[0].toUpperCase() + s.substr(1);
        }
        return split.join(' ');
      }


      Polymer({
        manifestLoaded: function(event) {
          var manifest = event.detail.response;

          this.setupConfiguratorTypes(manifest);
        },

        setupConfiguratorTypes: function(manifest) {
          var menu = this.querySelector('core-header-panel[drawer] core-menu')


          for (var configuratorType in manifest['configurator-types']) {
            var menuItem = Polymer.createDOM('paper-item', capitalize(configuratorType), {
              'data-configurator': true,
              'data-type': configuratorType
            });
            menu.appendChild(menuItem);

            
          }
        }
      })
    }());
  </script>
</polymer-element>